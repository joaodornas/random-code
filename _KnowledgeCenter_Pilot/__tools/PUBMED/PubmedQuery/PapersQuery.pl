use LWP::Simple;use warnings;$indexador = 'pubmed';$campo = '';$termo = 'causality+visual';$mindate = '1900';$maxdate = '2014';$usehistory = 'y';$retstart = '0';$retmax = '100000';$rettype = 'uilist';$datetype = 'pdat';$eutils = 'http://www.ncbi.nlm.nih.gov/entrez/eutils';$esearch = "$eutils/esearch.fcgi?" . "db=" . $indexador . "&term=" . $termo . "&field=" . $campo . "&usehistory=" . $usehistory . "&retstat=" . $retstart . "&retmax=" . $retmax . "&rettype=" . $rettype . "&datetype=" . $datetype . "&mindate=" . $mindate . "&maxdate=" . $maxdate;$esearch_result = get($esearch);$WebEnv = $1 if ($esearch_result =~ /<WebEnv>(\S+)<\/WebEnv>/);$QueryKey = $1 if ($esearch_result =~ /<QueryKey>(\d+)<\/QueryKey>/);$Count = $1 if ($esearch_result =~ /<Count>(\d+)<\/Count>/);print "Count = " . $Count;print "QueryKey = " . $QueryKey;print "WebEnv = " . $WebEnv;$filename = "esearch-" . $termo . ".txt";open(OUT_ESEARCH, ">" . $filename) || die "Could not open file!\n";print OUT_ESEARCH $esearch_result;close OUT_ESEARCH;$filename = $termo . ".xml";open(OUT_EFETCH, ">" . $filename) || die "Could not open file!\n";$retmax = 500;for ($retstart = 0; $retstart < $Count; $retstart += $retmax) {    $efetch_url = $eutils . "/efetch.fcgi?db=" . $indexador . "&WebEnv=" . $WebEnv;    $efetch_url .= "&query_key=" . $QueryKey . "&retstart=" . $retstart;    $efetch_url .= "&retmax=" . $retmax . "&rettype=&retmode=xml";    $efetch_out = get($efetch_url);    print OUT_EFETCH "$efetch_out";}close OUT_EFETCH;#$retmax = '100';#$str = $term;#$find = " ";#$replace = "+";#$find = quotemeta $find; # escape regex metachars if present#$str =~ s/$find/$replace/g;#$term = $str;#if ($num_terms > 1) {##    $command = ask_user("AND, OR, or NOT", "AND");##    $command = uc($command);##    for ($count = 2; $count <= $num_terms; $count++) {##        $each_term = ask_user("Term " . "$num_terms", "");##        $str = $each_term;#        $find = " ";#        $replace = "+";#        $find = quotemeta $find; # escape regex metachars if present#        $str =~ s/$find/$replace/g;#        $each_term = $str;##        $term = $term . "+" . $command . "+" . $each_term;##    }##}#$retstart;#$retmax=3;###for($retstart = 0; $retstart < $Count; $retstart += $retmax) {#  $efetch = "$utils/efetch.fcgi?" .#               "rettype=$report&retmode=text&retstart=$retstart&retmax=$retmax&" .#               "db=$db&query_key=$QueryKey&WebEnv=$WebEnv";###  print "\nEF_QUERY=$efetch\n";     ###  $efetch_result = get($efetch);#  #  print "---------\nEFETCH RESULT(". #         ($retstart + 1) . ".." . ($retstart + $retmax) . "): ".#        "[$efetch_result]\n-----PRESS ENTER!!!-------\n";#  <>;#}